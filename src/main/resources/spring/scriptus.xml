<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
       	http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       	http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd
       	http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
       	http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
       	"
		xmlns:p="http://www.springframework.org/schema/p"
		xmlns:context="http://www.springframework.org/schema/context"
                xmlns:tx="http://www.springframework.org/schema/tx"
		default-autowire="byName"
        default-init-method="init" default-destroy-method="destroy">
        
        <!-- Scriptus master Spring config file. -->

    <context:annotation-config/>

    <bean id="config" class="net.ex337.scriptus.config.ScriptusConfig" />

    <bean id="waker" class="net.ex337.scriptus.scheduler.ProcessWaker" />

    <bean id="routing" class="net.ex337.scriptus.transport.MessageRouting" />

    <bean id="locks" class="net.ex337.scriptus.scheduler.ProcessLocks" />

    <bean id="dummyTransport" class="net.ex337.scriptus.transport.impl.DummyTransport" 
    	p:defaultResponse="response">
    	<property name="regexpResponseMatchers">
			<map>
				<entry key="SYN" value="ACK"/>
				<entry key="D[A-Z]*G" value="CAT"/>
				<entry key="I have ([0-9]*) cats" value="I have $1 dogs"/>
			</map>
    	</property>
   	</bean>
    	
    <bean id="cmdLineTransport" class="net.ex337.scriptus.transport.impl.CommandLineTransport" />
    <bean id="twitterTransport" class="net.ex337.scriptus.transport.twitter.TwitterTransportImpl" />
    <bean id="facebookTransport" class="net.ex337.scriptus.transport.facebook.FacebookTransportImpl"/>
    
    <bean id="twitterClientMock" class="net.ex337.scriptus.transport.twitter.TwitterClientMock"/>
    <bean id="twitterClientImpl" class="net.ex337.scriptus.transport.twitter.TwitterClientImpl"/>

    <alias name="twitterClientImpl" alias="twitterClient" />

	<bean id="facebookClientImpl" class="net.ex337.scriptus.transport.facebook.FacebookClientImpl" />

	<alias name="facebookClientImpl" alias="facebookClient" />

    <bean id="transport" class="net.ex337.scriptus.transport.TransportSwitch" />

	<bean scope="prototype" id="scriptProcess" class="net.ex337.scriptus.model.ScriptProcess"/>

	<bean id="facade" class="net.ex337.scriptus.ScriptusFacade"/>

    <bean id="baseDatastore" abstract="true" >
		<lookup-method name="createScriptProcess" bean="scriptProcess"/>
    </bean>

     <bean id="memoryDatastore" parent="baseDatastore" class="net.ex337.scriptus.datastore.impl.ScriptusDatastoreMemoryImpl" />
     <bean id="fileDatastore" parent="baseDatastore" class="net.ex337.scriptus.datastore.impl.ScriptusDatastoreFileImpl" />
	 <bean id="awsDatastore" parent="baseDatastore" class="net.ex337.scriptus.datastore.impl.ScriptusDatastoreAWSImpl" />

	<bean id="datastore" class="net.ex337.scriptus.datastore.ScriptusDatastoreSwitch" />

    <bean id="scheduler" class="net.ex337.scriptus.scheduler.ProcessSchedulerImpl" />

</beans>